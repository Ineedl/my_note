## 镜像原理
镜像就是一个独立的轻量级可执行软件包，其包含运行环境与基于该运行环境开发的软件，它包含了某个软件需要的所有内容，包括代码，运行时库，运行时环境变量与软件配置文件。


## 联合文件系统
### Union文件系统的介绍
Union文件系统支持对文件系统的修改作为一次提交来一层层的叠加，Union文件系统为Docker镜像的基础。镜像可以通过分层来进行继承，可以用基础镜像(夫镜像)来制作各种具体的应用镜像。

* 联合文件系统一次会同时加载多个文件系统，但从外面看来只有一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件与目录。


## 镜像加载原理
### 镜像分层图
![](https://note.youdao.com/yws/api/personal/file/E3B64EBB1AE349F687F1816907A73A05?method=download&shareKey=82fe49ac386230fb49120afefb6c7cd8)


### 镜像层
docker镜像实际由一层层的文件系统组成。该分层中下层部分文件系统是通用的(比如rootfs)。

镜像启动时使用了系统的底层内核，但是容器使用的是不同的应用层。

* docker所有的镜像都起源于一个基础镜像

* docker pull在下载对应的镜像时，如果下载的镜像中部分文件层与已下载的镜像中的一些文件层相同，这些层次将不会下载，将会直接复用这些文件层。

举个例子：当你下载一个以linux为基础的镜像时，如果你已经拥有一个以linux为基础的镜像，那么下载这个镜像时的linux层相关文件将不用再次下载。

### 容器层
容器层只是一个抽象的说法。容器层记录了用户用某个容器打包成镜像时对该容器中对服务和应用的操作与配置。

* 容器层属于镜像的一部分，用户在部署镜像后对容器内部的修改后，再打包镜像将会在原有的基础上修改容器层。

* 下载镜像时不同配置之间的差异就是这个容器层的差异。