## 定义拆分

c#允许拆分一个[类](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/class)、一个[结构](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/builtin-types/struct)、一个[接口](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/interface)或一个方法的定义到两个或更多的文件中是可能的。 每个源文件包含类型或方法定义的一部分，编译应用程序时将把所有部分组合起来。

在以下几种情况下需要拆分类定义：

- 通过单独的文件声明某个类可以让多位程序员同时对该类进行处理。
- 你可以向该类中添加代码，而不必重新创建包括自动生成的源代码的源文件。 Visual Studio 在创建Windows 窗体、Web 服务包装器代码等时会使用这种方法。 你可以创建使用这些类的代码，这样就不需要修改由Visual Studio生成的文件。
- [源代码生成器](https://learn.microsoft.com/zh-cn/dotnet/csharp/roslyn-sdk/#source-generators)可以在类中生成额外的功能。

### 重要

定义拆分只是相当于把定义放在了几个地方，对于类的定义的性质，仍然遵循之前的语法，比如只能继承一个基类，可以实现多个接口等。

## partial 关键字

partial关键字用于声明部分类

```c#
// This is in Employee_Part1.cs
public partial class Employee
{
    public void DoWork()
    {
    }
}

// This is in Employee_Part2.cs
public partial class Employee
{
    public void GoToLunch()
    {
    }
}

//Main program demonstrating the Employee class usage
public class Program
{
    public static void Main()
    {
        Employee emp = new Employee();
        emp.DoWork();
        emp.GoToLunch();
    }
}

// Expected Output:
// Employee is working.
// Employee is at lunch.
```

### 使用限制

* 要作为同一类型的各个部分的所有分部类型定义都必须使用 `partial` 进行修饰。
* `partial` 修饰符只能出现在紧靠关键字 `class`、`struct` 或 `interface` 前面的位置。

* 分部类型定义中允许使用嵌套的分部类型，如下面的示例中所示：

  * ```
    partial class ClassWithNestedClass
    {
        partial class NestedClass { }
    }
    
    partial class ClassWithNestedClass
    {
        partial class NestedClass { }
    }
    ```

* 要成为同一类型的各个部分的所有分部类型定义都必须在同一程序集和同一模块（.exe 或 .dll 文件）中进行定义。 分部定义不能跨越多个模块。

* 类名和泛型类型参数在所有的分部类型定义中都必须匹配。 泛型类型可以是分部的。 每个分部声明都必须以相同的顺序使用相同的参数名。

* 下面用于分部类型定义中的关键字是可选的，但是如果某关键字出现在一个分部类型定义中，则必须在相同类型的其他分部定义中指定相同的关键字：

  - [公共](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/public)
  - [private](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/private)
  - [受保护](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/protected)
  - [internal](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/internal)
  - [abstract](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/abstract)
  - [sealed](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/sealed)
  - 基类
  - [new](https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/new-modifier) 修饰符（嵌套部分）
  - 泛型约束
