## 线程池大小不合适会带来的问题

过小会导致系统资源的不充分，也容易导致饥饿现象。

过大会导致过多的上下文切换，占用更多的系统资源。


## CPU密集型大小

```
线程数=CPU核数+1
```

该大小能够充分的使用CPU，让CPU时钟周期不被浪费。
+1是一个替补线程。当线程池中的另外8个线程因为操作系统的错误突然停止时，可以立马补充一个上去。


## I/O密集型运算

CPU不总是处于繁忙状态，只有在执行远程RPC，数据库业务操作等操作时，CPU就闲下来了。可以充分利用多线程来提高CPU效率。

经验公式

```
线程数 = 核数 * 期望CPU利用率 * 总时间(CPU计算时间+CPU等待时间) / CPU计算时间
```