## etcd集群特性

etcd集群中不分master和从节点。

### 集群算法

多个 etcd 节点通过 Raft 算法相互协作。Raft 算法会选择一个主节点作为 Leader，负责数据同步和分发。当 Leader 发生故障时，系统会自动选择另一个节点作为 Leader，以再次完成数据同步。当 etcd 完成内部状态和数据协作时，仅需选择一个节点即可读取和写入数据。

**Quorum** 指的是集群中大多数节点的意思。对于一个包含 `n` 个节点的 ETCD 集群，Quorum 必须包含 **至少 `⌈n/2⌉ + 1** 个节点**，即超过半数的节点。这个要求确保了系统在发生部分节点故障时依然能够保持一致性。

在 etcd 中，分布式共识算法由 Raft 实现。Raft 共识算法仅在任何两个 Quorum 具有共享成员时才可以工作。也就是说，任何有效的仲裁必须包含一个共享成员，该成员包含集群中所有已确认和已提交的数据。基于此，etcd 为 Raft 共识算法设计了一种数据同步机制，用于在更新 Leader 后同步最后 Quorum 所提交的所有数据。这样可以确保在群集状态更改时数据的一致性。

```
“两个 Quorum 具有共享成员”是什么意思？
在 Raft 中，为了确保数据的一致性，集群中的所有操作（如写入、Leader 选举等）必须得到 Quorum 节点 的确认。

当我们说 两个 Quorum 具有共享成员 时，是指集群中的两个不同的 Quorum 必须有一个共同的节点。这个共同的节点确保了数据的一致性，并且在 Leader 切换或集群发生变化时，数据能正确同步。

例子：
假设我们有 5 个节点，节点编号为 A, B, C, D, E。

集群的 Quorum 数量是 ⌈5/2⌉ + 1 = 3。假设在某个时刻：
Quorum 1 包括节点 A、B 和 C。
Quorum 2 包括节点 C、D 和 E。
这时，Quorum 1 和 Quorum 2 具有共享成员 C，因此，它们之间能够通过 C 来确保数据的一致性。
```

